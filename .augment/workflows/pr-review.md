# PR Review Workflow

This workflow automates comprehensive code reviews for pull requests using Augment Agent.

## Overview

When a PR is created, this workflow performs:
1. **Code Quality Analysis** - Check for code smells, anti-patterns, and style issues
2. **Security Review** - Identify potential security vulnerabilities
3. **Test Coverage Analysis** - Ensure adequate test coverage for changes
4. **Architecture Compliance** - Verify adherence to hexagonal architecture
5. **Documentation Check** - Ensure code changes are properly documented
6. **Performance Review** - Identify potential performance issues


### Manual PR Review

To manually review a PR using Augment Agent:

1. **Checkout the PR branch**
   ```bash
   gh pr checkout <PR_NUMBER>
   ```

2. **Open Augment Agent** and use this prompt:
   ```
   Review this PR following the workflow in .augment/workflows/pr-review.md

   PR: #<PR_NUMBER>
   Branch: <BRANCH_NAME>

   Perform a comprehensive code review covering:
   - Code quality and style
   - Security vulnerabilities
   - Test coverage
   - Architecture compliance
   - Documentation
   - Performance considerations
   ```

3. **Agent will**:
   - Analyze the diff
   - Run quality checks
   - Review test coverage
   - Check for security issues
   - Generate a detailed review comment

## Review Checklist

### 1. Code Quality
- [ ] Follows project coding conventions (see `docs/conventions/CODE_STYLE.md`)
- [ ] No code smells or anti-patterns
- [ ] Proper error handling
- [ ] Clear variable and function names
- [ ] Appropriate use of type hints
- [ ] No unnecessary complexity

### 2. Security
- [ ] No hardcoded secrets or credentials
- [ ] Proper input validation
- [ ] SQL injection prevention (parameterized queries)
- [ ] No command injection vulnerabilities
- [ ] Secure file operations (no path traversal)
- [ ] Authentication/authorization properly implemented

### 3. Testing
- [ ] Unit tests for new domain logic
- [ ] Integration tests for adapters
- [ ] API tests for new endpoints
- [ ] Test coverage ‚â• 80%
- [ ] Edge cases covered
- [ ] All tests passing

### 4. Architecture
- [ ] Follows hexagonal architecture pattern
- [ ] Domain logic has no I/O dependencies
- [ ] Proper use of ports and adapters
- [ ] Dependency injection used appropriately
- [ ] Clear separation of concerns

### 5. Documentation
- [ ] Docstrings for public functions/classes
- [ ] README updated if needed
- [ ] API documentation updated
- [ ] Comments explain "why", not "what"
- [ ] Complex logic is well-documented

### 6. Performance
- [ ] No N+1 query problems
- [ ] Efficient database queries
- [ ] Appropriate use of caching
- [ ] No unnecessary loops or iterations
- [ ] Proper use of async/await

## Review Output Format

The review should be posted as a PR comment in this format:

```markdown
## ü§ñ Augment Code Review

### Summary
[Brief overview of changes and overall assessment]

### ‚úÖ Strengths
- [Positive aspects of the PR]

### ‚ö†Ô∏è Issues Found

#### üî¥ Critical
- [Critical issues that must be fixed]

#### üü° Warnings
- [Issues that should be addressed]

#### üîµ Suggestions
- [Nice-to-have improvements]

### üìä Metrics
- **Files Changed**: X
- **Lines Added**: +X
- **Lines Removed**: -X
- **Test Coverage**: X%
- **Security Issues**: X

### üß™ Test Coverage
[Analysis of test coverage for changed files]

### üîí Security Analysis
[Security review findings]

### üìù Recommendations
1. [Specific actionable recommendations]

---
*Review generated by Augment Agent*
```

## Configuration

Review rules are defined in `.augment/rules/` and are **automatically applied** by Auggie CLI:

- **architecture.md** - Hexagonal architecture compliance, domain has no I/O
- **code-quality.md** - Code quality standards, naming, type hints
- **documentation.md** - Documentation requirements, docstrings
- **performance.md** - Performance best practices, no N+1 queries
- **security.md** - Security rules (CRITICAL), no secrets, input validation
- **testing.md** - Testing requirements (‚â•80% coverage), unit + integration tests

To customize, edit the rule files in `.augment/rules/` or add new ones.
